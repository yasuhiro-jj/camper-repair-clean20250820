<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†å°‚é–€AIãƒãƒ£ãƒƒãƒˆ</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        color: #333;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        height: 100vh;
        display: flex;
        flex-direction: column;
      }

      h1 {
        text-align: center;
        color: white;
        margin-bottom: 10px;
        font-size: 2.5em;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }

      .subtitle {
        text-align: center;
        color: rgba(255,255,255,0.9);
        margin-bottom: 30px;
        font-size: 1.1em;
      }

      .chat-header {
        background: rgba(255,255,255,0.95);
        padding: 15px 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      }

      .new-chat-btn {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
      }

      .new-chat-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(52,152,219,0.4);
      }

      .chat-info {
        color: #666;
        font-weight: bold;
      }

      .chat-container {
        flex: 1;
        background: rgba(255,255,255,0.95);
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        overflow: hidden;
      }

      .chat-messages {
        flex: 1;
        padding: 20px;
        overflow-y: auto;
        max-height: 60vh;
      }

      .message {
        margin-bottom: 20px;
        display: flex;
        align-items: flex-start;
      }

      .message.user {
        justify-content: flex-end;
      }

      .message.ai {
        justify-content: flex-start;
      }

      .message-content {
        max-width: 70%;
        padding: 15px 20px;
        border-radius: 20px;
        word-wrap: break-word;
      }

      .message.user .message-content {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        border-bottom-right-radius: 5px;
      }

      .message.ai .message-content {
        background: #f8f9fa;
        color: #333;
        border: 1px solid #e9ecef;
        border-bottom-left-radius: 5px;
      }

      .message-time {
        font-size: 0.8em;
        color: #999;
        margin-top: 5px;
        text-align: right;
      }

      .chat-input-area {
        padding: 20px;
        border-top: 1px solid #e9ecef;
        background: #f8f9fa;
      }

      .chat-form {
        margin-bottom: 15px;
      }

      .input-group {
        display: flex;
        gap: 10px;
      }

      .chat-input {
        flex: 1;
        padding: 15px 20px;
        border: 2px solid #e9ecef;
        border-radius: 25px;
        font-size: 16px;
        outline: none;
        transition: border-color 0.3s ease;
      }

      .chat-input:focus {
        border-color: #3498db;
      }

      .send-btn {
        background: linear-gradient(45deg, #3498db, #2980b9);
        color: white;
        border: none;
        padding: 15px 20px;
        border-radius: 50%;
        cursor: pointer;
        font-size: 18px;
        transition: all 0.3s ease;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .send-btn:hover {
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(52,152,219,0.4);
      }

      .quick-questions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 15px;
      }

      .quick-btn {
        background: #f39c12;
        color: white;
        border: none;
        padding: 8px 15px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      .quick-btn:hover {
        background: #e67e22;
        transform: translateY(-2px);
      }

      .loading {
        text-align: center;
        color: #666;
        font-style: italic;
        padding: 20px;
      }

      .links-section {
        margin-top: 20px;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 10px;
        border-left: 4px solid #3498db;
      }

      .links-section h3 {
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .links-section ul {
        list-style: none;
        padding: 0;
      }

      .links-section li {
        margin-bottom: 8px;
        padding: 8px 12px;
        background: white;
        border-radius: 5px;
        border-left: 3px solid #3498db;
      }

      .links-section a {
        color: #3498db;
        text-decoration: none;
        font-weight: 500;
      }

      .links-section a:hover {
        text-decoration: underline;
      }

      /* ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      .support-center-info {
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 5px solid #e74c3c;
      }

      .support-center-info h2 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.5em;
        text-align: center;
      }

      .support-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }

      .info-item {
        background: #f8f9fa;
        padding: 12px 15px;
        border-radius: 8px;
        border-left: 3px solid #3498db;
        font-size: 0.95em;
      }

      .info-item strong {
        color: #2c3e50;
        display: inline-block;
        margin-right: 8px;
      }

      .contact-form-btn {
        color: #3498db;
        text-decoration: none;
        font-weight: bold;
        padding: 8px 15px;
        background: linear-gradient(45deg, #f39c12, #e67e22);
        color: white;
        border-radius: 8px;
        display: inline-block;
        margin-left: 10px;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(243, 156, 18, 0.3);
      }

      .contact-form-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(243, 156, 18, 0.4);
        background: linear-gradient(45deg, #e67e22, #d35400);
      }

      /* é–¢é€£ãƒ–ãƒ­ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      .related-blogs {
        background: rgba(255,255,255,0.95);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border-left: 5px solid #27ae60;
        display: none;
      }

      .related-blogs h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.3em;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
      }

      .blog-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 15px;
        margin-top: 15px;
      }

      .blog-card {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 15px;
        border-left: 4px solid #27ae60;
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .blog-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(39,174,96,0.2);
      }

      .blog-title {
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 8px;
        font-size: 1.1em;
      }

      .blog-excerpt {
        color: #666;
        font-size: 0.9em;
        line-height: 1.4;
        margin-bottom: 10px;
      }

      .blog-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.8em;
        color: #999;
      }

      .blog-tags {
        display: flex;
        gap: 5px;
        flex-wrap: wrap;
      }

      .blog-tag {
        background: #27ae60;
        color: white;
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.7em;
      }

      /* ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
      .chat-messages::-webkit-scrollbar {
        width: 8px;
      }

      .chat-messages::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 4px;
      }

      .chat-messages::-webkit-scrollbar-thumb {
        background: #c1c1c1;
        border-radius: 4px;
      }

      .chat-messages::-webkit-scrollbar-thumb:hover {
        background: #a8a8a8;
      }

      /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }

        h1 {
          font-size: 2em;
        }

        .chat-header {
          flex-direction: column;
          gap: 10px;
        }

        .message-content {
          max-width: 85%;
        }

        .quick-questions {
          justify-content: center;
        }

        .support-details {
          grid-template-columns: 1fr;
        }

                 .support-center-info h2 {
           font-size: 1.3em;
         }

         .blog-grid {
           grid-template-columns: 1fr;
         }

         .blog-card {
           padding: 12px;
         }
       }
    </style>
  </head>
  <body>
         <!-- JavaScriptç„¡åŠ¹æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
     <noscript>
       <div style="background: #e74c3c; color: white; padding: 20px; text-align: center; margin: 20px; border-radius: 10px;">
         <h2>âš ï¸ JavaScriptãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã¾ã™</h2>
         <p>ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ­£å¸¸ã«å‹•ä½œã•ã›ã‚‹ã«ã¯ã€JavaScriptã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„ã€‚</p>
         <p>ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§JavaScriptã‚’æœ‰åŠ¹ã«ã—ã¦ã‹ã‚‰ã€ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚</p>
       </div>
     </noscript>
     
     <div class="container">
       <h1>ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†å°‚é–€AIãƒãƒ£ãƒƒãƒˆ</h1>
       <p class="subtitle">çµŒé¨“è±Šå¯ŒãªAIãŒã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ã®ä¿®ç†ã«ã¤ã„ã¦è©³ã—ããŠç­”ãˆã—ã¾ã™</p>

             <!-- å²¡å±±ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ± -->
       <div class="support-center-info" id="supportCenter">
         <h2>ğŸ¢ å²¡å±±ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼</h2>
         <div class="support-details">
                       <div class="info-item">
              <strong>ğŸ“ æ‰€åœ¨åœ°:</strong> å²¡å±±çœŒå²¡å±±å¸‚åŒ—åŒºæ±å¤æ¾485-4 2F
            </div>
            <div class="info-item">
              <strong>ğŸ“ é›»è©±ç•ªå·:</strong> 086-206-6622
            </div>
            <div class="info-item">
              <strong>ğŸ“§ ãŠå•ã„åˆã‚ã›:</strong> 
              <a href="https://camper-repair.net/contact/" target="_blank" class="contact-form-btn">
                ğŸ“ ãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ 
              </a>
            </div>
            <div class="info-item">
              <strong>ğŸ•’ å–¶æ¥­æ™‚é–“:</strong> å¹´ä¸­ç„¡ä¼‘ï¼ˆ9:00ï½21:00ï¼‰
            </div>
           <div class="info-item">
             <strong>ğŸ”§ å¯¾å¿œã‚µãƒ¼ãƒ“ã‚¹:</strong> ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ãƒ»éƒ¨å“äº¤æ›ãƒ»ç·Šæ€¥å¯¾å¿œ
           </div>
           <div class="info-item">
             <strong>ğŸš— å¯¾å¿œè»Šç¨®:</strong> å…¨ãƒ¡ãƒ¼ã‚«ãƒ¼ã®ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒ»RVè»Š
           </div>
           <div class="info-item">
             <strong>ğŸ› ï¸ å°‚é–€åˆ†é‡:</strong> é›»æ°—ç³»çµ±ãƒ»çµ¦æ’æ°´ãƒ»ã‚¬ã‚¹è¨­å‚™ãƒ»å†·æš–æˆ¿ãƒ»è»Šä½“ä¿®ç†
           </div>
           <div class="info-item">
             <strong>ğŸš¨ ç·Šæ€¥å¯¾å¿œ:</strong> 24æ™‚é–“ç·Šæ€¥ä¿®ç†å¯¾å¿œï¼ˆè¦äº‹å‰ç™»éŒ²ï¼‰
           </div>
           <div class="info-item">
             <strong>ğŸ’³ æ”¯æ‰•ã„æ–¹æ³•:</strong> ç¾é‡‘ãƒ»ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ãƒ»éŠ€è¡ŒæŒ¯è¾¼
           </div>
         </div>
       </div>

      <!-- ãƒãƒ£ãƒƒãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ -->
      <div class="chat-header">
        <button onclick="startNewConversation()" class="new-chat-btn">ğŸ†• æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹</button>
        <div class="chat-info">
          <span>ğŸ’¬ ä¼šè©±å‹ãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ</span>
        </div>
      </div>

             <!-- é–¢é€£ãƒ–ãƒ­ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
       <div id="relatedBlogs" class="related-blogs">
         <h3>ğŸ“ é–¢é€£ãƒ–ãƒ­ã‚°è¨˜äº‹</h3>
         <div id="blogGrid" class="blog-grid">
           <!-- ãƒ–ãƒ­ã‚°è¨˜äº‹ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
         </div>
       </div>

       <!-- ãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
       <div class="chat-container">
         <div id="chatMessages" class="chat-messages">
           <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
         </div>
        
        <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
        <div class="chat-input-area">
          <form id="questionForm" class="chat-form">
            <div class="input-group">
              <input
                type="text"
                id="question"
                name="question"
                placeholder="ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ã®ä¿®ç†ã«ã¤ã„ã¦è³ªå•ã—ã¦ãã ã•ã„..."
                required
                class="chat-input"
              />
              <button type="submit" class="send-btn">ğŸ“¤</button>
            </div>
          </form>
          
          <!-- ã‚¯ã‚¤ãƒƒã‚¯è³ªå•ãƒœã‚¿ãƒ³ -->
          <div class="quick-questions">
            <button onclick="setQuestion('ã‚¨ãƒ³ã‚¸ãƒ³ãŒå§‹å‹•ã—ãªã„å ´åˆã®å¯¾å‡¦æ³•ã‚’æ•™ãˆã¦ãã ã•ã„')" class="quick-btn">ã‚¨ãƒ³ã‚¸ãƒ³ãŒå§‹å‹•ã—ãªã„</button>
            <button onclick="setQuestion('çµ¦æ’æ°´ã‚·ã‚¹ãƒ†ãƒ ã®æ•…éšœæ™‚ã®ä¿®ç†æ–¹æ³•ã¯ï¼Ÿ')" class="quick-btn">çµ¦æ’æ°´ã‚·ã‚¹ãƒ†ãƒ </button>
            <button onclick="setQuestion('é›»æ°—ç³»çµ±ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ–¹æ³•')" class="quick-btn">é›»æ°—ç³»çµ±</button>
            <button onclick="setQuestion('å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ï¼Ÿ')" class="quick-btn">ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      function setQuestion(question) {
        document.getElementById('question').value = question;
        document.getElementById('question').focus();
      }

      // ä¼šè©±å±¥æ­´ã‚’ç®¡ç†
      let conversationHistory = [];
      
      // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å›ç­”æ©Ÿèƒ½
      function getOfflineAnswer(question) {
        const questionLower = question.toLowerCase();
        
        if (questionLower.includes('ã‚¨ãƒ³ã‚¸ãƒ³') || questionLower.includes('å§‹å‹•')) {
          return `ã€çŠ¶æ³ç¢ºèªã€‘
ã‚¨ãƒ³ã‚¸ãƒ³ãŒå§‹å‹•ã—ãªã„å•é¡Œã§ã™ã­ã€‚ã¾ãšã€ä»¥ä¸‹ã®ç‚¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ã€ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
â€¢ ãƒãƒƒãƒ†ãƒªãƒ¼ã®é›»åœ§ã‚’ç¢ºèªï¼ˆ12Vä»¥ä¸Šå¿…è¦ï¼‰
â€¢ ç‡ƒæ–™ã‚¿ãƒ³ã‚¯ã«ç‡ƒæ–™ãŒæ®‹ã£ã¦ã„ã‚‹ã‹ç¢ºèª
â€¢ ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«ã®é‡ã¨çŠ¶æ…‹ã‚’ç¢ºèª
â€¢ ã‚¹ãƒ‘ãƒ¼ã‚¯ãƒ—ãƒ©ã‚°ã®çŠ¶æ…‹ã‚’ç¢ºèª

ã€è¿½åŠ ã®è³ªå•ã€‘
â€¢ ã‚¨ãƒ³ã‚¸ãƒ³ã¯å…¨ãåå¿œã—ã¾ã›ã‚“ã‹ï¼Ÿ
â€¢ ã‚­ãƒ¼ã‚’å›ã—ãŸæ™‚ã®éŸ³ã¯èã“ãˆã¾ã™ã‹ï¼Ÿ
â€¢ æœ€è¿‘ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çŠ¶æ³ã¯ï¼Ÿ

ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã€‘
ä¸Šè¨˜ã®ç¢ºèªã‚’è¡Œã£ãŸå¾Œã€çµæœã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

ã€æœ€å¾Œã«ã€‘
è©³ç´°ãªè¨ºæ–­ãŒå¿…è¦ãªå ´åˆã¯ã€å²¡å±±ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼ã¾ã§ãŠé›»è©±ãã ã•ã„ã€‚`;
        } else if (questionLower.includes('é›»æ°—') || questionLower.includes('é›»è£…')) {
          return `ã€çŠ¶æ³ç¢ºèªã€‘
é›»æ°—ç³»çµ±ã®ãƒˆãƒ©ãƒ–ãƒ«ã§ã™ã­ã€‚ã©ã®ã‚ˆã†ãªç—‡çŠ¶ãŒç¾ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ

ã€ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
â€¢ ãƒ’ãƒ¥ãƒ¼ã‚ºãƒœãƒƒã‚¯ã‚¹ã®ç¢ºèª
â€¢ ãƒãƒƒãƒ†ãƒªãƒ¼ç«¯å­ã®æ¥ç¶šçŠ¶æ…‹ç¢ºèª
â€¢ é…ç·šã®æ–­ç·šã‚„ã‚·ãƒ§ãƒ¼ãƒˆã®ç¢ºèª
â€¢ ã‚¹ã‚¤ãƒƒãƒé¡ã®å‹•ä½œç¢ºèª

ã€è¿½åŠ ã®è³ªå•ã€‘
â€¢ ã©ã®éƒ¨åˆ†ã®é›»æ°—ãŒä½¿ãˆã¾ã›ã‚“ã‹ï¼Ÿ
â€¢ ãƒ’ãƒ¥ãƒ¼ã‚ºã¯ç¢ºèªã—ã¾ã—ãŸã‹ï¼Ÿ
â€¢ æœ€è¿‘ã®å·¥äº‹ã‚„æ”¹é€ ã¯ã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ

ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã€‘
ç—‡çŠ¶ã‚’è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚

ã€æœ€å¾Œã«ã€‘
é›»æ°—ç³»çµ±ã®ä¿®ç†ã¯å°‚é–€çŸ¥è­˜ãŒå¿…è¦ã§ã™ã€‚å®‰å…¨ã®ãŸã‚ã€å°‚é–€åº—ã§ã®ä¿®ç†ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚`;
        } else if (questionLower.includes('æ°´') || questionLower.includes('çµ¦æ’æ°´')) {
          return `ã€çŠ¶æ³ç¢ºèªã€‘
çµ¦æ’æ°´ã‚·ã‚¹ãƒ†ãƒ ã®å•é¡Œã§ã™ã­ã€‚å…·ä½“çš„ãªç—‡çŠ¶ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

ã€ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
â€¢ æ°´é“ãƒãƒ³ãƒ—ã®å‹•ä½œç¢ºèª
â€¢ é…ç®¡ã®è©°ã¾ã‚Šç¢ºèª
â€¢ ã‚¿ãƒ³ã‚¯ã®æ°´æ¼ã‚Œç¢ºèª
â€¢ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®æ¸…æƒ

ã€è¿½åŠ ã®è³ªå•ã€‘
â€¢ æ°´ãŒå‡ºãªã„ã€ãã‚Œã¨ã‚‚æ¼ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ
â€¢ ãƒãƒ³ãƒ—ã®éŸ³ã¯èã“ãˆã¾ã™ã‹ï¼Ÿ
â€¢ æœ€è¿‘ã®ä½¿ç”¨çŠ¶æ³ã¯ï¼Ÿ

ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã€‘
ç—‡çŠ¶ã‚’è©³ã—ãæ•™ãˆã¦ãã ã•ã„ã€‚

ã€æœ€å¾Œã«ã€‘
çµ¦æ’æ°´ã‚·ã‚¹ãƒ†ãƒ ã®ä¿®ç†ã¯å°‚é–€çŸ¥è­˜ãŒå¿…è¦ã§ã™ã€‚`;
        } else {
          return `ã€çŠ¶æ³ç¢ºèªã€‘
ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ã®ä¿®ç†ã«ã¤ã„ã¦ã”ç›¸è«‡ã§ã™ã­ã€‚

ã€ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘
â€¢ ç—‡çŠ¶ã‚’è©³ã—ãæ•™ãˆã¦ãã ã•ã„
â€¢ å®‰å…¨ç¢ºèªã‚’æœ€å„ªå…ˆã«è¡Œã£ã¦ãã ã•ã„
â€¢ å°‚é–€çŸ¥è­˜ãŒå¿…è¦ãªå ´åˆã¯å°‚é–€åº—ã«ç›¸è«‡

ã€è¿½åŠ ã®è³ªå•ã€‘
â€¢ å…·ä½“çš„ã«ã©ã®ã‚ˆã†ãªå•é¡ŒãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã‹ï¼Ÿ
â€¢ ã„ã¤ã‹ã‚‰ç—‡çŠ¶ãŒç¾ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿ
â€¢ æœ€è¿‘ã®ä½¿ç”¨çŠ¶æ³ã¯ï¼Ÿ

ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã€‘
è©³ç´°ãªç—‡çŠ¶ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚

ã€æœ€å¾Œã«ã€‘
å²¡å±±ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ä¿®ç†ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼ã¾ã§ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚`;
        }
      }
      
      // ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šãƒ†ã‚¹ãƒˆæ©Ÿèƒ½
      function testServerConnection() {
        fetch('/ask', {
          method: 'POST',
          body: new URLSearchParams({ question: 'ãƒ†ã‚¹ãƒˆæ¥ç¶š' }),
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
          },
        })
        .then(response => {
          console.log('ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸ:', response.status);
          return response.json();
        })
        .then(data => {
          console.log('ã‚µãƒ¼ãƒãƒ¼å¿œç­”:', data);
        })
        .catch(error => {
          console.error('ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šã‚¨ãƒ©ãƒ¼:', error);
          addMessage("âš ï¸ ã‚µãƒ¼ãƒãƒ¼ã¨ã®æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§ç¢ºèªã—ã¦ãã ã•ã„ï¼š\n\n1. Anacondaãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§Flaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª\n2. ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5000 ã«ã‚¢ã‚¯ã‚»ã‚¹\n3. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª", false);
        });
      }
      
      function startNewConversation() {
        // ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢
        document.getElementById('chatMessages').innerHTML = '';
        
        // ä¼šè©±å±¥æ­´ã‚’ãƒªã‚»ãƒƒãƒˆ
        conversationHistory = [];
        
        // æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹
        fetch('/start_conversation', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          }
        })
        .then(response => {
          console.log('Start conversation response status:', response.status);
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          console.log('æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹ã—ã¾ã—ãŸ:', data.conversation_id);
          
          // åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
          setTimeout(() => {
            addMessage("ã“ã‚“ã«ã¡ã¯ï¼ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ã®ä¿®ç†ã«ã¤ã„ã¦ä½•ã§ã‚‚ãŠèã‹ã›ãã ã•ã„ã€‚ã‚¨ãƒ³ã‚¸ãƒ³ã®å•é¡Œã€é›»æ°—ç³»çµ±ã®æ•…éšœã€çµ¦æ’æ°´ã®å•é¡Œãªã©ã€ã©ã‚“ãªã“ã¨ã§ã‚‚ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚", false);
          }, 500);
        })
        .catch(error => {
          console.error('æ–°ã—ã„ä¼šè©±é–‹å§‹ã‚¨ãƒ©ãƒ¼:', error);
          addMessage("ã‚µãƒ¼ãƒãƒ¼ã¨ã®æ¥ç¶šã«å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚Flaskã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚", false);
        });
      }

                   function addMessage(content, isUser = false) {
        const chatMessages = document.getElementById('chatMessages');
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
        
        const messageContent = document.createElement('div');
        messageContent.className = 'message-content';
        
        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ã‚’å‡¦ç†
        if (isUser) {
          messageContent.textContent = content;
        } else {
          // AIã®å›ç­”ã‚’HTMLå½¢å¼ã§å‡¦ç†
          let processedContent = content
            .replace(/ã€çŠ¶æ³ç¢ºèªã€‘/g, '<h3 style="color: #27ae60; margin-top: 20px; margin-bottom: 15px; border-bottom: 2px solid #27ae60; padding-bottom: 5px;">ğŸ’¬ çŠ¶æ³ç¢ºèª</h3>')
            .replace(/ã€ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘/g, '<h3 style="color: #2c3e50; margin-top: 20px; margin-bottom: 15px; border-bottom: 2px solid #3498db; padding-bottom: 5px;">ğŸ”§ ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>')
            .replace(/ã€è¿½åŠ ã®è³ªå•ã€‘/g, '<h3 style="color: #f39c12; margin-top: 20px; margin-bottom: 15px; border-bottom: 2px solid #f39c12; padding-bottom: 5px;">â“ è¿½åŠ ã®è³ªå•</h3>')
            .replace(/ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã€‘/g, '<h3 style="color: #9b59b6; margin-top: 20px; margin-bottom: 15px; border-bottom: 2px solid #9b59b6; padding-bottom: 5px;">ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>')
            .replace(/ã€æœ€å¾Œã«ã€‘/g, '<h3 style="color: #e74c3c; margin-top: 20px; margin-bottom: 15px; border-bottom: 2px solid #e74c3c; padding-bottom: 5px;">ğŸ“ ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼</h3>');
          
          // ç®‡æ¡æ›¸ãã‚’å‡¦ç†
          const lines = processedContent.split('\n');
          let processedLines = [];
          let inList = false;
          
          for (let line of lines) {
            if (line.trim().startsWith('â€¢')) {
              if (!inList) {
                processedLines.push('<ul style="margin: 10px 0; padding-left: 20px;">');
                inList = true;
              }
              processedLines.push(`<li style="margin-bottom: 8px; padding-left: 10px; position: relative;">${line.trim()}</li>`);
            } else {
              if (inList) {
                processedLines.push('</ul>');
                inList = false;
              }
              processedLines.push(line);
            }
          }
          
          if (inList) {
            processedLines.push('</ul>');
          }
          
          messageContent.innerHTML = processedLines.join('\n');
          
          // ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—è³ªå•ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ï¼ˆAIã®å›ç­”ã®å ´åˆã®ã¿ï¼‰
          if (!isUser && content.includes('ã€è¿½åŠ ã®è³ªå•ã€‘')) {
            const followUpDiv = document.createElement('div');
            followUpDiv.className = 'follow-up-questions';
            followUpDiv.style.marginTop = '15px';
            followUpDiv.style.paddingTop = '15px';
            followUpDiv.style.borderTop = '1px solid #e9ecef';
            
            const followUpTitle = document.createElement('div');
            followUpTitle.style.fontWeight = 'bold';
            followUpTitle.style.marginBottom = '10px';
            followUpTitle.style.color = '#2c3e50';
            followUpTitle.textContent = 'ğŸ’¡ é–¢é€£ã™ã‚‹è³ªå•:';
            
            followUpDiv.appendChild(followUpTitle);
            
            const followUpButtons = [
              'ã‚¨ãƒ³ã‚¸ãƒ³ã®çŠ¶æ…‹ã¯ã©ã†ã§ã™ã‹ï¼Ÿ',
              'é›»æ°—ç³»çµ±ã«ç•°å¸¸ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',
              'æœ€è¿‘ã®ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çŠ¶æ³ã¯ï¼Ÿ',
              'ä»–ã®ç—‡çŠ¶ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ'
            ];
            
            followUpButtons.forEach(btnText => {
              const btn = document.createElement('button');
              btn.textContent = btnText;
              btn.className = 'follow-up-btn';
              btn.style.cssText = `
                background: #3498db;
                color: white;
                border: none;
                padding: 8px 12px;
                border-radius: 15px;
                margin: 5px;
                cursor: pointer;
                font-size: 12px;
                transition: all 0.3s ease;
              `;
              btn.onmouseover = () => {
                btn.style.background = '#2980b9';
                btn.style.transform = 'translateY(-1px)';
              };
              btn.onmouseout = () => {
                btn.style.background = '#3498db';
                btn.style.transform = 'translateY(0)';
              };
              btn.onclick = () => {
                document.getElementById('question').value = btnText;
                document.getElementById('questionForm').dispatchEvent(new Event('submit'));
              };
              followUpDiv.appendChild(btn);
            });
            
            messageContent.appendChild(followUpDiv);
          }
        }
        
        const messageTime = document.createElement('div');
        messageTime.className = 'message-time';
        messageTime.textContent = new Date().toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
        
        messageDiv.appendChild(messageContent);
        messageDiv.appendChild(messageTime);
        chatMessages.appendChild(messageDiv);
        
        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’æœ€ä¸‹éƒ¨ã«
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

       // é–¢é€£ãƒ–ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹é–¢æ•°
       function showRelatedBlogs(blogs) {
         const blogSection = document.getElementById('relatedBlogs');
         const blogGrid = document.getElementById('blogGrid');
         
         if (!blogs || blogs.length === 0) {
           blogSection.style.display = 'none';
           return;
         }
         
         blogGrid.innerHTML = '';
         
         blogs.forEach(blog => {
           const blogCard = document.createElement('div');
           blogCard.className = 'blog-card';
           blogCard.onclick = () => window.open(blog.url, '_blank');
           
           blogCard.innerHTML = `
             <div class="blog-title">${blog.title}</div>
             <div class="blog-excerpt">${blog.excerpt}</div>
             <div class="blog-meta">
               <div class="blog-tags">
                 ${blog.tags.map(tag => `<span class="blog-tag">${tag}</span>`).join('')}
               </div>
               <div>${blog.date}</div>
             </div>
           `;
           
           blogGrid.appendChild(blogCard);
         });
         
         blogSection.style.display = 'block';
       }

               // ãƒ–ãƒ­ã‚°æ¤œç´¢æ©Ÿèƒ½
        function searchRelatedBlogs(query) {
          // ã‚·ãƒŠãƒªã‚ª1-20ã«åŸºã¥ã„ãŸãƒ–ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿
          const sampleBlogs = [
            {
              title: 'ã‚µãƒ–ãƒãƒƒãƒ†ãƒªãƒ¼ãŒæ•°æ™‚é–“ã§ç©ºã«ãªã‚‹åŸå› ã¨å¯¾å‡¦æ³•',
              excerpt: 'èµ°è¡Œå……é›»ä¸è¶³ã€ãƒãƒƒãƒ†ãƒªãƒ¼åŠ£åŒ–ã€å®¶é›»ã®é€£ç¶šä½¿ç”¨ãªã©ã€ã‚µãƒ–ãƒãƒƒãƒ†ãƒªãƒ¼ãŒæ—©ãç©ºã«ãªã‚‹åŸå› ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚',
              tags: ['ã‚µãƒ–ãƒãƒƒãƒ†ãƒªãƒ¼', 'å……é›»', 'æ•…éšœ'],
              date: '2024-01-15',
              url: '#'
            },
            {
              title: 'èµ°è¡Œä¸­ã«ã‚µãƒ–ãƒãƒƒãƒ†ãƒªãƒ¼ãŒå……é›»ã•ã‚Œãªã„å•é¡Œ',
              excerpt: 'ã‚¢ã‚¤ã‚½ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚„DC-DCã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã®æ•…éšœè¨ºæ–­æ–¹æ³•ã¨ã€æ­£å¸¸ãªå……é›»é›»åœ§ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['ã‚µãƒ–ãƒãƒƒãƒ†ãƒªãƒ¼', 'ã‚¢ã‚¤ã‚½ãƒ¬ãƒ¼ã‚¿ãƒ¼', 'å……é›»'],
              date: '2024-01-12',
              url: '#'
            },
            {
              title: 'æ°´é“ãƒãƒ³ãƒ—ãŒå‹•ã‹ãªã„æ™‚ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°',
              excerpt: 'ãƒãƒ³ãƒ—ãŒç„¡éŸ³ã§å‹•ä½œã—ãªã„å ´åˆã®åŸå› ã¨ã€ãƒ’ãƒ¥ãƒ¼ã‚ºã€é…ç·šã€ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼ã‚¹ã‚¤ãƒƒãƒã®ç¢ºèªæ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚',
              tags: ['æ°´é“ãƒãƒ³ãƒ—', 'æ•…éšœ', 'é…ç·š'],
              date: '2024-01-10',
              url: '#'
            },
            {
              title: 'æ°´é“ãƒãƒ³ãƒ—ã‹ã‚‰æ°´ãŒå‡ºãªã„æ™‚ã®å¯¾å‡¦æ³•',
              excerpt: 'ãƒãƒ³ãƒ—éŸ³ã¯ã™ã‚‹ã®ã«æ°´ãŒå‡ºãªã„å ´åˆã®åŸå› ã¨ã€ã‚¹ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼æ¸…æƒã€ã‚¨ã‚¢æŠœãã®æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚',
              tags: ['æ°´é“ãƒãƒ³ãƒ—', 'ã‚¹ãƒˆãƒ¬ãƒ¼ãƒŠãƒ¼', 'æ°´æ¼ã‚Œ'],
              date: '2024-01-08',
              url: '#'
            },
            {
              title: 'ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ã®ç‚¹ç«ã‚¹ãƒ‘ãƒ¼ã‚¯ãŒå‡ºãªã„æ™‚ã®ä¿®ç†æ–¹æ³•',
              excerpt: 'ç‚¹ç«ãƒ—ãƒ©ã‚°ã®é›»æ± äº¤æ›ã‹ã‚‰é…ç·šç‚¹æ¤œã¾ã§ã€ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãŒç‚¹ç«ã—ãªã„åŸå› ã¨å¯¾å‡¦æ³•ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚',
              tags: ['ã‚¬ã‚¹ã‚³ãƒ³ãƒ­', 'ç‚¹ç«', 'é›»æ± '],
              date: '2024-01-05',
              url: '#'
            },
            {
              title: 'ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ã®ç«ãŒæ¶ˆãˆã‚‹å•é¡Œã®è§£æ±ºæ³•',
              excerpt: 'ã‚µãƒ¼ãƒ¢ã‚«ãƒƒãƒ—ãƒ«ã®æ„Ÿåº¦èª¿æ•´ã¨ç‚æ¤œçŸ¥è£…ç½®ã®ä½ç½®èª¿æ•´æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['ã‚¬ã‚¹ã‚³ãƒ³ãƒ­', 'ã‚µãƒ¼ãƒ¢ã‚«ãƒƒãƒ—ãƒ«', 'ç‚æ¤œçŸ¥'],
              date: '2024-01-03',
              url: '#'
            },
            {
              title: 'ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ‘ãƒãƒ«ã®ç™ºé›»åŠ¹ç‡ä½ä¸‹ã®åŸå› ã¨å¯¾ç­–',
              excerpt: 'ãƒ‘ãƒãƒ«ã®æ±šã‚Œã€é…ç·šã®æ–­ç·šã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®æ•…éšœãªã©ã€ç™ºé›»åŠ¹ç‡ãŒæ‚ªã„åŸå› ã‚’è§£èª¬ã—ã¾ã™ã€‚',
              tags: ['ã‚½ãƒ¼ãƒ©ãƒ¼ãƒ‘ãƒãƒ«', 'ç™ºé›»', 'åŠ¹ç‡'],
              date: '2023-12-28',
              url: '#'
            },
            {
              title: 'ãƒˆã‚¤ãƒ¬ã®æ°´æ¼ã‚Œã¨è©°ã¾ã‚Šã®ä¿®ç†æ–¹æ³•',
              excerpt: 'ãƒˆã‚¤ãƒ¬ã®æ°´æ¼ã‚Œç®‡æ‰€ã®ç‰¹å®šæ–¹æ³•ã¨ã€è©°ã¾ã‚Šã®è§£æ¶ˆã€ã‚·ãƒ¼ãƒ«äº¤æ›ã®æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚',
              tags: ['ãƒˆã‚¤ãƒ¬', 'æ°´æ¼ã‚Œ', 'è©°ã¾ã‚Š'],
              date: '2023-12-25',
              url: '#'
            },
            {
              title: 'é›»è£…ç³»ã®ãƒˆãƒ©ãƒ–ãƒ«è¨ºæ–­ã¨ä¿®ç†ã‚¬ã‚¤ãƒ‰',
              excerpt: 'ãƒ’ãƒ¥ãƒ¼ã‚ºåˆ‡ã‚Œã€é…ç·šæ–­ç·šã€ã‚¹ã‚¤ãƒƒãƒæ•…éšœãªã©ã€é›»è£…ç³»ã®ä¸€èˆ¬çš„ãªå•é¡Œã¨è§£æ±ºæ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚',
              tags: ['é›»è£…ç³»', 'ãƒ’ãƒ¥ãƒ¼ã‚º', 'é…ç·š'],
              date: '2023-12-20',
              url: '#'
            },
            {
              title: 'ãƒ«ãƒ¼ãƒ•ãƒ™ãƒ³ãƒˆãƒ»æ›æ°—æ‰‡ã®æ•…éšœã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹',
              excerpt: 'æ›æ°—æ‰‡ã®å‹•ä½œä¸è‰¯ã€ç•°éŸ³ã€æ°´æ¼ã‚Œãªã©ã®å•é¡Œã¨ã€å®šæœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['ãƒ«ãƒ¼ãƒ•ãƒ™ãƒ³ãƒˆ', 'æ›æ°—æ‰‡', 'ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹'],
              date: '2023-12-18',
              url: '#'
            },
            {
              title: 'å®¶å…·ã®ç ´æä¿®ç†ã¨è£œå¼·æ–¹æ³•',
              excerpt: 'ãƒ†ãƒ¼ãƒ–ãƒ«ã€ãƒ™ãƒƒãƒ‰ã€åç´ã®ç ´æç®‡æ‰€ã®ä¿®ç†æ–¹æ³•ã¨ã€è€ä¹…æ€§ã‚’å‘ä¸Šã•ã›ã‚‹è£œå¼·ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚',
              tags: ['å®¶å…·', 'ä¿®ç†', 'è£œå¼·'],
              date: '2023-12-15',
              url: '#'
            },
            {
              title: 'å¤–éƒ¨é›»æºã®æ¥ç¶šãƒˆãƒ©ãƒ–ãƒ«ã¨è§£æ±ºæ³•',
              excerpt: 'å¤–éƒ¨é›»æºã‹ã‚‰ã®å……é›»ãŒã§ããªã„å ´åˆã®åŸå› ã¨ã€é…ç·šã€ã‚³ãƒã‚¯ã‚¿ãƒ¼ã€å……é›»å™¨ã®ç‚¹æ¤œæ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚',
              tags: ['å¤–éƒ¨é›»æº', 'å……é›»', 'é…ç·š'],
              date: '2023-12-12',
              url: '#'
            },
            {
              title: 'é›¨æ¼ã‚Šã®åŸå› ç‰¹å®šã¨ä¿®ç†æ–¹æ³•',
              excerpt: 'å¤©äº•ã€çª“å‘¨ã‚Šã€é…ç®¡ã‹ã‚‰ã®é›¨æ¼ã‚Šã®åŸå› ç‰¹å®šã¨ã€ã‚·ãƒ¼ãƒªãƒ³ã‚°æã«ã‚ˆã‚‹ä¿®ç†æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['é›¨æ¼ã‚Š', 'ã‚·ãƒ¼ãƒªãƒ³ã‚°', 'ä¿®ç†'],
              date: '2023-12-10',
              url: '#'
            },
            {
              title: 'FFãƒ’ãƒ¼ã‚¿ãƒ¼ã®æ•…éšœè¨ºæ–­ã¨ä¿®ç†ã‚¬ã‚¤ãƒ‰',
              excerpt: 'FFãƒ’ãƒ¼ã‚¿ãƒ¼ãŒå‹•ä½œã—ãªã„åŸå› ã¨ã€æ¸©é¢¨ãŒå‡ºãªã„ã€ç•°éŸ³ãŒã™ã‚‹ãªã©ã®å•é¡Œã®è§£æ±ºæ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™ã€‚',
              tags: ['FFãƒ’ãƒ¼ã‚¿ãƒ¼', 'æ•…éšœ', 'æ¸©é¢¨'],
              date: '2023-12-08',
              url: '#'
            },
            {
              title: 'ã‚¤ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã®æ•…éšœã¨äº¤æ›æ™‚æœŸ',
              excerpt: 'ã‚¤ãƒ³ãƒãƒ¼ã‚¿ãƒ¼ã®å‹•ä½œä¸è‰¯ã€éç†±ã€å‡ºåŠ›é›»åœ§ç•°å¸¸ãªã©ã®ç—‡çŠ¶ã¨å¯¾å‡¦æ³•ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['ã‚¤ãƒ³ãƒãƒ¼ã‚¿ãƒ¼', 'æ•…éšœ', 'é›»åœ§'],
              date: '2023-12-05',
              url: '#'
            },
            {
              title: 'å®¤å†…LEDç…§æ˜ã®æ•…éšœã¨äº¤æ›æ–¹æ³•',
              excerpt: 'LEDç…§æ˜ã®ç‚¹ç¯ä¸è‰¯ã€ã¡ã‚‰ã¤ãã€æ˜åº¦ä½ä¸‹ãªã©ã®å•é¡Œã¨ã€é©åˆ‡ãªäº¤æ›æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚',
              tags: ['LEDç…§æ˜', 'æ•…éšœ', 'äº¤æ›'],
              date: '2023-12-03',
              url: '#'
            },
            {
              title: 'æ’æ°´ã‚¿ãƒ³ã‚¯ã®è©°ã¾ã‚Šã¨æ¸…æƒæ–¹æ³•',
              excerpt: 'æ’æ°´ã‚¿ãƒ³ã‚¯ã®è©°ã¾ã‚ŠåŸå› ã¨ã€å®šæœŸçš„ãªæ¸…æƒã€é˜²è‡­å¯¾ç­–ã«ã¤ã„ã¦è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚',
              tags: ['æ’æ°´ã‚¿ãƒ³ã‚¯', 'è©°ã¾ã‚Š', 'æ¸…æƒ'],
              date: '2023-11-30',
              url: '#'
            },
            {
              title: 'ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦ã®æ°´æ¼ã‚Œã¨ã‚·ãƒ¼ãƒ«äº¤æ›',
              excerpt: 'ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦å‘¨ã‚Šã®æ°´æ¼ã‚Œä¿®ç†ã¨ã€ã‚´ãƒ ã‚·ãƒ¼ãƒ«ã®äº¤æ›æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦', 'æ°´æ¼ã‚Œ', 'ã‚·ãƒ¼ãƒ«'],
              date: '2023-11-28',
              url: '#'
            },
            {
              title: 'è»Šä½“å¤–è£…ã®ç ´æä¿®ç†ã¨è£œä¿®æ–¹æ³•',
              excerpt: 'è»Šä½“ã®å‚·ã€ã¸ã“ã¿ã€ã‚¯ãƒ©ãƒƒã‚¯ã®ä¿®ç†æ–¹æ³•ã¨ã€å¡—è£…è£œä¿®ã®æ‰‹é †ã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚',
              tags: ['è»Šä½“å¤–è£…', 'ç ´æ', 'å¡—è£…'],
              date: '2023-11-25',
              url: '#'
            },
            {
              title: 'ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ã®ç•°éŸ³è¨ºæ–­ã¨å¯¾ç­–',
              excerpt: 'èµ°è¡Œä¸­ã®ç•°éŸ³ã€æŒ¯å‹•ã€ãã—ã¿éŸ³ã®åŸå› ç‰¹å®šã¨ã€é©åˆ‡ãªå¯¾å‡¦æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚',
              tags: ['ç•°éŸ³', 'æŒ¯å‹•', 'è¨ºæ–­'],
              date: '2023-11-22',
              url: '#'
            },
            {
              title: 'å†·è”µåº«ã®æ•…éšœã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ–¹æ³•',
              excerpt: 'å†·è”µåº«ã®å†·å´ä¸è‰¯ã€éœœä»˜ãã€ç•°éŸ³ãªã©ã®å•é¡Œã¨ã€å®šæœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚',
              tags: ['å†·è”µåº«', 'å†·å´', 'ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹'],
              date: '2023-11-20',
              url: '#'
            }
          ];
         
         // ã‚¯ã‚¨ãƒªã«åŸºã¥ã„ã¦é–¢é€£ãƒ–ãƒ­ã‚°ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
         const relatedBlogs = sampleBlogs.filter(blog => {
           const searchTerms = query.toLowerCase().split(' ');
           const blogText = (blog.title + ' ' + blog.excerpt + ' ' + blog.tags.join(' ')).toLowerCase();
           
           return searchTerms.some(term => blogText.includes(term));
         });
         
         showRelatedBlogs(relatedBlogs);
       }



      document.getElementById("questionForm").addEventListener("submit", function (event) {
        event.preventDefault();

        const question = document.getElementById("question").value;
        if (!question.trim()) return;

                         // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
        addMessage(question, true);
        
        // ä¼šè©±å±¥æ­´ã«è¿½åŠ 
        conversationHistory.push({ role: 'user', content: question });
        
        // é–¢é€£ãƒ–ãƒ­ã‚°ã‚’æ¤œç´¢ã—ã¦è¡¨ç¤º
        searchRelatedBlogs(question);
        
        // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
        document.getElementById("question").value = "";

        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ 
        const loadingDiv = document.createElement('div');
        loadingDiv.className = 'message ai';
        loadingDiv.innerHTML = `
          <div class="message-content">
            <div class="loading">ğŸ”§ ä¿®ç†ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆä¸­...</div>
          </div>
        `;
        document.getElementById('chatMessages').appendChild(loadingDiv);
        document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;

        fetch("/ask", {
          method: "POST",
          body: new URLSearchParams({ question: question }),
          headers: {
            "Content-Type": "application/x-www-form-urlencoded",
          },
        })
          .then((response) => {
            console.log('Response status:', response.status);
            console.log('Response headers:', response.headers);
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
          })
          .then((data) => {
            console.log('Response data:', data);
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
            const loadingMessages = document.querySelectorAll('.message.ai .loading');
            loadingMessages.forEach(msg => msg.parentElement.parentElement.remove());
            
            // AIã®å›ç­”ã‚’è¿½åŠ 
            const aiAnswer = data.answer || "å›ç­”ãŒã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚";
            addMessage(aiAnswer, false);
            
            // ä¼šè©±å±¥æ­´ã«AIã®å›ç­”ã‚’è¿½åŠ 
            conversationHistory.push({ role: 'assistant', content: aiAnswer });
          })
          .catch((error) => {
            console.error("Error:", error);
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤
            const loadingMessages = document.querySelectorAll('.message.ai .loading');
            loadingMessages.forEach(msg => msg.parentElement.parentElement.remove());
            
            // ã‚ªãƒ•ãƒ©ã‚¤ãƒ³æ©Ÿèƒ½ã¨ã—ã¦åŸºæœ¬çš„ãªå›ç­”ã‚’æä¾›
            const offlineAnswer = getOfflineAnswer(question);
            addMessage(offlineAnswer, false);
          });
      });

      // Enterã‚­ãƒ¼ã§é€ä¿¡
      document.getElementById('question').addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          document.getElementById('questionForm').dispatchEvent(new Event('submit'));
        }
      });

      // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹
      document.addEventListener('DOMContentLoaded', function() {
        console.log('DOMContentLoaded ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç«ã—ã¾ã—ãŸ');
        
        try {
          // æ–°ã—ã„ä¼šè©±ã‚’é–‹å§‹
          startNewConversation();
          console.log('startNewConversation ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ');
          
          // åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
          setTimeout(() => {
            addMessage("ã“ã‚“ã«ã¡ã¯ï¼ã‚­ãƒ£ãƒ³ãƒ”ãƒ³ã‚°ã‚«ãƒ¼ã®ä¿®ç†ã«ã¤ã„ã¦ä½•ã§ã‚‚ãŠèã‹ã›ãã ã•ã„ã€‚ã‚¨ãƒ³ã‚¸ãƒ³ã®å•é¡Œã€é›»æ°—ç³»çµ±ã®æ•…éšœã€çµ¦æ’æ°´ã®å•é¡Œãªã©ã€ã©ã‚“ãªã“ã¨ã§ã‚‚ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ã€‚", false);
          }, 500);
          
          // ã‚µãƒ¼ãƒãƒ¼æ¥ç¶šãƒ†ã‚¹ãƒˆ
          setTimeout(() => {
            testServerConnection();
          }, 1000);
          
          // ãƒ‡ãƒãƒƒã‚°ç”¨ï¼šã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±ã¨ãƒ–ãƒ­ã‚°æ©Ÿèƒ½ã®ç¢ºèª
          const supportElement = document.querySelector('.support-center-info');
          const blogElement = document.getElementById('relatedBlogs');
          const supportById = document.getElementById('supportCenter');
          
          console.log('ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±è¦ç´ :', supportElement);
          console.log('é–¢é€£ãƒ–ãƒ­ã‚°è¦ç´ :', blogElement);
          console.log('ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±è¦ç´ ï¼ˆIDï¼‰:', supportById);
          
          // ãƒšãƒ¼ã‚¸å…¨ä½“ã®HTMLæ§‹é€ ã‚’ç¢ºèª
          console.log('ãƒšãƒ¼ã‚¸ã®HTMLæ§‹é€ :', document.body.innerHTML.substring(0, 500));
          
          if (supportElement) {
            console.log('ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™');
          } else {
            console.log('ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
          }
          
          if (blogElement) {
            console.log('é–¢é€£ãƒ–ãƒ­ã‚°è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ');
          } else {
            console.log('é–¢é€£ãƒ–ãƒ­ã‚°è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
          }
          
          // ãƒ†ã‚¹ãƒˆç”¨ï¼šã‚µãƒ³ãƒ—ãƒ«ãƒ–ãƒ­ã‚°ã‚’è¡¨ç¤º
          setTimeout(() => {
            console.log('ãƒ†ã‚¹ãƒˆãƒ–ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ã¾ã™');
            const testBlogs = [
              {
                title: 'ãƒ†ã‚¹ãƒˆãƒ–ãƒ­ã‚°è¨˜äº‹',
                excerpt: 'ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ–ãƒ­ã‚°è¨˜äº‹ã§ã™ã€‚',
                tags: ['ãƒ†ã‚¹ãƒˆ'],
                date: '2024-01-01',
                url: '#'
              }
            ];
            showRelatedBlogs(testBlogs);
            console.log('showRelatedBlogs ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ');
          }, 1000);
          
        } catch (error) {
          console.error('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
        }
      });
      
             // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å‰ã®ãƒ‡ãƒãƒƒã‚°
       console.log('ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ');
       
       // é–¢æ•°ã®å­˜åœ¨ç¢ºèª
       console.log('showRelatedBlogs é–¢æ•°:', typeof showRelatedBlogs);
       console.log('searchRelatedBlogs é–¢æ•°:', typeof searchRelatedBlogs);
       
       // JavaScriptæœ‰åŠ¹æ€§ãƒ†ã‚¹ãƒˆ
       function testJavaScript() {
         console.log('âœ… JavaScriptãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™');
         alert('JavaScriptãŒæœ‰åŠ¹ã§ã™ï¼');
         return true;
       }
       
               // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«JavaScriptãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
        if (typeof testJavaScript === 'function') {
          console.log('âœ… JavaScripté–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™');
        } else {
          console.log('âŒ JavaScripté–¢æ•°ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“');
        }
        
        // å³åº§ã«ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
        console.log('=== JavaScript ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
        testJavaScript();
        
        // è¦ç´ ã®å­˜åœ¨ç¢ºèª
        setTimeout(() => {
          console.log('=== è¦ç´ ç¢ºèªãƒ†ã‚¹ãƒˆ ===');
          const supportElement = document.querySelector('.support-center-info');
          const blogElement = document.getElementById('relatedBlogs');
          
          console.log('ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼è¦ç´ :', supportElement);
          console.log('ãƒ–ãƒ­ã‚°è¦ç´ :', blogElement);
          
          if (supportElement) {
            console.log('âœ… ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™');
            supportElement.style.border = '3px solid red';
          } else {
            console.log('âŒ ã‚µãƒãƒ¼ãƒˆã‚»ãƒ³ã‚¿ãƒ¼æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
          }
          
          if (blogElement) {
            console.log('âœ… ãƒ–ãƒ­ã‚°è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ');
            blogElement.style.border = '3px solid blue';
          } else {
            console.log('âŒ ãƒ–ãƒ­ã‚°è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
          }
        }, 100);
    </script>
  </body>
</html>